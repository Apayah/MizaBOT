# MizaBOT  
* [Granblue Fantasy](http://game.granbluefantasy.jp) Discord Bot used by the /gbfg/ server.  
#### Requirements  
* Python 3.7.  
* [discord.py](https://github.com/Rapptz/discord.py) (formerly the rewrite branch).  
* `pip install -r requirements.txt` to install all the modules.  
### Usage  
* The bot designed to be used on [Heroku](https://www.heroku.com).  
* Do a git push to your [Heroku](https://www.heroku.com) app but don't expect it to work right away.  
* You need to setup a config.json with your discord tokens, and more.  
### Examples  
* Check the [example](https://github.com/MizaGBF/MizaBOT/tree/master/example) folder for minimal config and save files.  
* `credentials.json` needs to be generated by yourself before using it on [Heroku](https://www.heroku.com).  
### Details  
Random explanations on the bot inner workings if you need some help for your own bot:  
* A custom loop is used instead of the regular bot loop, to handle possible exceptions or crashes, check the end of [bot.py](https://github.com/MizaGBF/MizaBOT/blob/master/bot.py) for more details.  
* Only three background tasks are usually running: `backtask()`, once every 40 minutes to change the bot status and save changes, `minutetask()`, once every minute to handle the reminder system and the Lucilius Party System used by /gbfg/ and `checkGWBuff` a few times every day to handle the GW buff announcement system used by my [Granblue Fantasy](http://game.granbluefantasy.jp) crew.  
* The `GracefulExit` is needed for a proper use on [Heroku](https://www.heroku.com). A `SIGTERM` signal is sent when a restart happens on the [Heroku](https://www.heroku.com) side (every 24 hours, when you push a change or in some other cases).  
* [asyncio](https://docs.python.org/3/library/asyncio.html) is used by [discord.py](https://github.com/Rapptz/discord.py), there is no multithreading involved in this bot as a result.  
* [Heroku](https://www.heroku.com) apps have no persistent storage, [PyDrive](https://pypi.org/project/PyDrive/) is used to read and write save files to my google drive.  
* `baguette.py` is a black box and won't ever be on this github, but the bot can run without.  
* `debug_channel` refers to a channel, in my test server, where the bot send debug and error messages. Useful when I can't check the logs.  